---
# The test setup includes:
# - Create flat_object mapping for test_partial_flat_object index
# - Index two example documents
# - Refresh the index so it is ready for search tests

setup:
  - do:
      indices.create:
        index: test_partial_flat_object
        body:
          mappings:
            properties:
              issue:
                properties:
                  number:
                    type : "integer"
                  labels:
                    type : "flat_object"
  - do:
      index:
        index: test_partial_flat_object
        id: 1
        body: {
          "issue": {
            "number": 123,
            "labels": {
              "version": "2.2",
              "backport": [
                "2.0",
                "1.9"
              ],
              "category": {
                "type": "API",
                "level": "bug"
              },
              "createdDate": "2023-01-01",
              "comment" : [["Doe","Shipped"],["John","Approved"]]
            }
          }
        }

  - do:
      index:
        index: test_partial_flat_object
        id: 2
        body: {
          "issue": {
            "number": 456,
            "labels": {
              "version": "2.1",
              "backport": [
                "2.0",
                "1.3"
              ],
              "category": {
                "type": "API",
                "level": "enhancement"
              },
              "createdDate": "2023-02-01",
              "comment" : [["Mike","LGTM"],["John","Approved"]]
            }
          }
        }
  - do:
      indices.refresh:
        index: test_partial_flat_object
---
# Delete Index when connection is teardown
teardown:
  - do:
      indices.delete:
        index: test_partial_flat_object


